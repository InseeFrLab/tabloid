<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exporter le tableau dans un classeur • tabloid</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exporter le tableau dans un classeur">
<meta property="og:description" content="tabloid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabloid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Contenu du package</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aa_presentation_package.html">Présentation du package</a>
    </li>
    <li>
      <a href="../articles/bb_creer_tableau_croise.html">Construire un tableau croisé</a>
    </li>
    <li>
      <a href="../articles/cc_calculer_profil_ligne_colonne.html">Calculer un profil ligne ou colonne</a>
    </li>
    <li>
      <a href="../articles/dd_arrondir_tableau.html">Gérer les arrondis d'un tableau croisé</a>
    </li>
    <li>
      <a href="../articles/ee_masquer_partie_contenu_tableau.html">Masquer une partie du contenu du tableau</a>
    </li>
    <li>
      <a href="../articles/ff_afficher_joli_tableau_html.html">Afficher un tableau mis en forme</a>
    </li>
    <li>
      <a href="../articles/gg_exporter_joli_tableau_xlsx.html">Exporter le tableau dans un classeur</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.insee.fr/espace-charges-etudes/boite-outils/tableaux" class="external-link">
    <span class="fa fa-gitlab"></span>
     
    Code source
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gg_exporter_joli_tableau_xlsx_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exporter le tableau dans un classeur</h1>
            
      
      
      <div class="hidden name"><code>gg_exporter_joli_tableau_xlsx.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="description-rapide">Description rapide<a class="anchor" aria-label="anchor" href="#description-rapide"></a>
</h2>
<p>La fonction <code><a href="../reference/tab_xlsx.html">tab_xlsx()</a></code> permet d’exporter le tableau mis en forme dans un fichier .xlsx, de manière à pouvoir l’envoyer à quelqu’un ou à le retravailler, sous Calc par exemple. Ce n’est pas la solution préconisée pour la reproductibilité des analyses, mais cela convient à beaucoup de cas de figures à l’Insee.</p>
<p>Elle prend en entrée un objet tab et l’exporte un fichier .xlsx dont le nom et le chemin sont donnés par l’utilisateur. Elle fait appel au package <code>open_xlsx</code>. Elle s’utilise après une instruction <code><a href="../reference/tab_build.html">tab_build()</a></code>, et doit intervenir en dernier, après toutes les fonctions de customisation éventuelles (<code><a href="../reference/tab_pct.html">tab_pct()</a></code>, <code><a href="../reference/tab_round.html">tab_round()</a></code> ou <code><a href="../reference/tab_mask.html">tab_mask()</a></code>).</p>
<!-- L'utilisateur doit choisir entre `tab_render` ou `tab_xlsx`, selon sa préférence ou son cas de figure. -->
</div>
<div class="section level2">
<h2 id="utilisation-de-la-fonction">Utilisation de la fonction<a class="anchor" aria-label="anchor" href="#utilisation-de-la-fonction"></a>
</h2>
<div class="section level3">
<h3 id="exporter-le-tableau-au-format-xlsx">Exporter le tableau au format xlsx<a class="anchor" aria-label="anchor" href="#exporter-le-tableau-au-format-xlsx"></a>
</h3>
<div class="section level4">
<h4 id="chemin-du-fichier-et-nom-de-longlet">Chemin du fichier et nom de l’onglet<a class="anchor" aria-label="anchor" href="#chemin-du-fichier-et-nom-de-longlet"></a>
</h4>
<p>Pour exporter un tableau dans un classeur excel, il est nécessaire de renseigner le chemin du fichier, ainsi que le nom de l’onglet dans lequel exporter le tableau.</p>
<ul>
<li>on indique dans le paramètre <code>path</code> le chemin du fichier dans lequel exporter les résultats. Il faut indiquer le nom complet du chemin, ainsi que l’extension “.xlsx”. Si le dossier dans lequel on souhaite enregistrer le classeur n’existe pas, il est créé automatiquement.</li>
<li>le paramètre <code>sheet</code> permet de renseigner le nom de l’onglet dans lequel est exporté le tableau. Si le classeur existe déjà, un nouvel onglet est ajouté.</li>
</ul>
<blockquote>
<p>! Attention : si un onglet existe déjà avec le même nom dans le classeur, le contenu est remplacé : cela permet de mettre à jour le contenu d’un onglet (en cas de correction). Pour ne pas écraser l’onglet existant, il est important de choisir un autre nom.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prenoms_mixtes_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_build.html">tab_build</a></span><span class="op">(</span>var_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lib_reg</span>, <span class="va">prenom</span><span class="op">)</span>,</span>
<span>            var_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">annais</span>, <span class="va">sexe</span><span class="op">)</span>,</span>
<span>            var_stat <span class="op">=</span> <span class="va">nombre</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tab_xlsx.html">tab_xlsx</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Z:/donnees_prenoms/resultats_prenoms.xlsx"</span>, </span>
<span>           sheet <span class="op">=</span> <span class="st">"comp_1900_2020"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/tab_xlsx.png"></p>
</div>
<div class="section level4">
<h4 id="mise-à-jour-du-contenu-du-fichier">Mise à jour du contenu du fichier<a class="anchor" aria-label="anchor" href="#mise-%C3%A0-jour-du-contenu-du-fichier"></a>
</h4>
<ul>
<li><p>le paramètre <code>update</code> permet de préciser si on souhaite mettre à jour le fichier .xlsx. S’il est à <code>FALSE</code>, le fichier ne sera pas mis à jour : la fonction vérifie alors qu’aucun onglet ne portant déjà le même nom que celui renseigné n’existe dans le classeur. Dans le cas contraire, un message d’erreur indique à l’utilisateur de modifier le nom d’onglet choisi.</p></li>
<li><p>le paramètre <code>open_wb</code> permet d’ouvrir automatiquement le fichier excel créé ou non.</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="mettre-en-forme-le-tableau">Mettre en forme le tableau<a class="anchor" aria-label="anchor" href="#mettre-en-forme-le-tableau"></a>
</h3>
<div class="section level4">
<h4 id="titre-et-note">Titre et note<a class="anchor" aria-label="anchor" href="#titre-et-note"></a>
</h4>
<p>De la même façon que pour la fonction <a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/ff_afficher_joli_tableau_html.htm" class="external-link">tab_render()</a>, les paramètres <code>title</code> et <code>note</code> de la fonction permettent d’ajouter un titre ou une note de bas de page au tableau.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prenoms_mixtes_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_build.html">tab_build</a></span><span class="op">(</span>var_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lib_reg</span>, <span class="va">prenom</span><span class="op">)</span>,</span>
<span>            var_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">annais</span>, <span class="va">sexe</span><span class="op">)</span>,</span>
<span>            var_stat <span class="op">=</span> <span class="va">nombre</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tab_xlsx.html">tab_xlsx</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Z:/donnees_prenoms/resultats_prenoms.xlsx"</span>, </span>
<span>           sheet <span class="op">=</span> <span class="st">"comp_1900_2020"</span>,</span>
<span>           title <span class="op">=</span> <span class="st">"Camille &amp; Charlie : des prénoms plus souvent féminins en 2020 qu'en 1900"</span>,</span>
<span>             note <span class="op">=</span> <span class="st">"Source : Insee - base des prénoms"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/tab_xlsx_title.png"></p>
</div>
<div class="section level4">
<h4 id="modification-des-libellés">Modification des libellés<a class="anchor" aria-label="anchor" href="#modification-des-libell%C3%A9s"></a>
</h4>
<p>Les intitulés des lignes et des colonnes se modifient également de la même façon que pour la fonction <a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/ff_afficher_joli_tableau_html.htm" class="external-link">tab_render()</a>.</p>
<ul>
<li>
<code>lab_rows</code> permet de modifier les intitulés des variables en ligne. On renseigne les nouveaux libellés à utiliser pour le tableau dans un vecteur de caractères.</li>
</ul>
<p>On peut ainsi remplacer les libellés “lib_reg” et “prenom” par les intitulés correspondant “Région” et “Prénom” de la façon suivante :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prenoms_mixtes_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_build.html">tab_build</a></span><span class="op">(</span>var_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lib_reg</span>, <span class="va">prenom</span><span class="op">)</span>,</span>
<span>            var_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">annais</span>, <span class="va">sexe</span><span class="op">)</span>,</span>
<span>            var_stat <span class="op">=</span> <span class="va">nombre</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/tab_xlsx.html">tab_xlsx</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Z:/donnees_prenoms/resultats_prenoms.xlsx"</span>, </span>
<span>            sheet <span class="op">=</span> <span class="st">"comp_1900_2020"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Camille &amp; Charlie : des prénoms plus souvent féminins en 2020 qu'en 1900"</span>,</span>
<span>            note <span class="op">=</span> <span class="st">"Source : Insee - base des prénoms"</span>,</span>
<span>            lab_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Région"</span>, <span class="st">"Prénom"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/tab_xlsx_rows.png"></p>
<ul>
<li>
<code>lab_cols</code> permet de modifier les libellés des intitulés des variables colonnes. Ce paramètre est à renseigner sous forme de liste. Chaque élément de la liste permet de préciser la variable concernée, et les nouveaux libellés des différentes modalités.</li>
</ul>
<p>Dans l’exemple, on souhaite modifier uniquement les libellés de la variable “sexe”, pour remplacer les modalités “G/F” par “Garçon/Fille”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prenoms_mixtes_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_build.html">tab_build</a></span><span class="op">(</span>var_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lib_reg</span>, <span class="va">prenom</span><span class="op">)</span>,</span>
<span>            var_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">annais</span>, <span class="va">sexe</span><span class="op">)</span>,</span>
<span>            var_stat <span class="op">=</span> <span class="va">nombre</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/tab_xlsx.html">tab_xlsx</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"Z:/donnees_prenoms/resultats_prenoms.xlsx"</span>, </span>
<span>            sheet <span class="op">=</span> <span class="st">"comp_1900_2020"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Camille &amp; Charlie : des prénoms plus souvent féminins en 2020 qu'en 1900"</span>,</span>
<span>            note <span class="op">=</span> <span class="st">"Source : Insee - base des prénoms"</span>,</span>
<span>            lab_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Région"</span>, <span class="st">"Prénom"</span><span class="op">)</span>,</span>
<span>            lab_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sexe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Garçon"</span>, <span class="st">"Fille"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/tab_xlsx_cols.png"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="liens-vers-les-autres-vignettes">Liens vers les autres vignettes<a class="anchor" aria-label="anchor" href="#liens-vers-les-autres-vignettes"></a>
</h2>
<p>Les vignettes suivantes présentent plus en détail l’utilisation des différentes fonctions :</p>
<ul>
<li><a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/bb_creer_tableau_croise.html" class="external-link">tab_build() : construire un tableau croisé</a></li>
<li><a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/cc_calculer_profil_ligne_colonne.html" class="external-link">tab_pct() : calculer un profil ligne ou colonne</a></li>
<li><a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/dd_arrondir_tableau.html" class="external-link">tab_round() : gérer les arrondis d’un tableau croisé</a></li>
<li><a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/ee_masquer_partie_contenu_tableau.html" class="external-link">tab_mask() : masquer une partie du contenu d’un tableau</a></li>
<li><a href="http://espace-charges-etudes.gitlab-pages.insee.fr/boite-outils/tableaux/articles/ff_afficher_joli_tableau_html.html" class="external-link">tab_render() : afficher un tableau mis en forme</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maëlle Fontaine, Laurette Cretin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
